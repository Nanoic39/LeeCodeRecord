package Tencent.LeeCode.Binary_DP_410;

class Solution {
    public int splitArray(int[] nums, int k) {

        // è¾¹ç•Œæƒ…å†µ
        if (nums.length == 1) { return nums[nums.length - 1]; }
        
        // ç¡®å®šäºŒåˆ†æŸ¥æ‰¾ä¸Šä¸‹ç•Œ
        long left = 0, right = 0;
        for (int num : nums) {
            left = Math.max(left, num); // ä¸‹ç•Œï¼šæ•°ç»„å…ƒç´ æœ€å¤§å€¼
            right += num; // ä¸Šç•Œï¼šå…ƒç´ å’Œ
        }

        // äºŒåˆ†æŸ¥æ‰¾
        while (left < right) {
            // çŒœæµ‹æœ€ä¼˜è§£
            long mid = left + (right - left) / 2;
            
            // éªŒè¯çŒœæµ‹çš„æœ€ä¼˜è§£ï¼ˆå¦‚æžœä½¿ç”¨midä½œä¸ºæœ€å¤§å’Œï¼Œéœ€è¦åˆ†å‰²å¤šå°‘ä¸ªæ•°ç»„ï¼‰
            int count = 1; // è‡³å°‘åˆ†å‰²ä¸ºä¸€ä¸ªæ•°ç»„
            long currSum = 0; // å½“å‰åˆ†å‰²æ•°ç»„çš„å’Œ
            for (int num : nums) {
                // ä¸ºä»€ä¹ˆè¿™é‡Œå¯ä»¥å…ˆåŠ å…¥åŽåˆ¤æ–­ï¼Ÿä¸ä¼šå¯¼è‡´å¤šåŠ å…¥ä¸€ä¸ªå¯¼è‡´è¶…å‡ºmidçš„numå—ï¼Ÿ
                // 1. è¿™é‡Œåªæ˜¯ç”¨æ¥åˆ¤æ–­åŠ å…¥è¯¥å…ƒç´ æ˜¯å¦ä¼šå¯¼è‡´è¶…é™ï¼ˆæ˜¯å¦éœ€è¦å¼€æ–°çš„æ•°ç»„ï¼‰
                //    å¦‚æžœè¶…é™å°±å¢žåŠ æ•°ç»„ä¸ªæ•°å¹¶å°†å¯¼è‡´è¶…é™çš„å…ƒç´ ä½œä¸ºæ–°æ•°ç»„çš„é¦–ä¸ªå…ƒç´ 
                //    æ‰€ä»¥å¯ä»¥è¿™ä¹ˆå†™
                // æ˜Žæ˜Žæ˜¯å¾ˆç®€å•å¾ˆå¥½ç†è§£çš„é€»è¾‘å´è¦æƒ³åŠå¤©ï¼ŒnncçœŸæ˜¯ðŸ·å•Š...
                currSum += num;
                if (currSum > mid) {
                    count++;
                    currSum = num; // å¼€ä¸€ä¸ªæ–°æ•°ç»„å¹¶ä½œä¸ºç¬¬ä¸€ä¸ªå…ƒç´ åŠ å…¥
                }
            }

            if (count <= k) {
                // åˆ†å‰²åŽçš„æ•°ç»„æ•°é‡å°äºŽç­‰äºŽå‡†å¤‡åˆ†å‰²æˆçš„ä¸ªæ•°ï¼Œè¯´æ˜Žmidçš„å€¼å¯èƒ½åå¤§äº†ï¼Œå°è¯•æ›´å°çš„å€¼ï¼ˆå³è¾¹ç•Œç¼©å°ï¼‰
                right = mid;
            } else {
                // åˆ†å‰²åŽçš„æ•°ç»„æ•°é‡å¤§äºŽå‡†å¤‡åˆ†å‰²æˆçš„ä¸ªæ•°ï¼Œè¯´æ˜Žmidåå°äº†ï¼Œéœ€è¦çŒœæµ‹æ›´å¤§çš„å€¼ï¼ˆå·¦è¾¹ç•Œå¢žå¤§ï¼‰
                left = mid + 1;
            }

        }
        
        return (int) left; // æœ€ç»ˆ left == rightï¼Œå¾—å‡ºç»“æžœï¼Œè½¬æ¢ä¸ºintç±»åž‹è¿”å›ž
        
    }
}